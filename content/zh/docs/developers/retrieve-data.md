---
title: "检索数据"
description: "本指引将说明如何使用 Lotus 检索存储在 Filecoin 网络上的数据。"
lead: "本指引将说明如何使用 Lotus 检索存储在 Filecoin 网络上的数据。"
draft: false
menu:
    docs:
        parent: "developers"
weight: 345
toc: true
---

数据 检索是通过 _检索存储供应商_　来 _检索交易_. 在此协议中，客户端同意为一定的数据支付存储应商一定的费用。使用支付管道[payment channel]({{< relref "payment-channels" >}})　一边取回数据, 一边逐渐支付。与存储交易不同的是检索交易发生在区块链外。

目前，Lotus 支持从最初存储数据的存储供应商直接 检索数据; 尽管根据网络规范， 有计划通过支持专门致力于该业务的独立检索存储供应商，使检索成为一种高效、快速和可靠的操作。到那时，客户将能够在网络上搜索他们所需数据的所有可能供应商（通过DHT、链或带外聚合器），比较交易条款，并选择最适合他们需求的检索方案。　　

## 设置

要从 Filecoin 网络中检索数据，Lotus 节点需要:

1. 使用所需的数据 CID 对储存数据的存储供应商执行检索查询。
2. 收到存储供货商的确认，确认它持有该数据并且可以提供检索的价格。
3. 发送同意提议条款的交易提议。
4. 接收存储供应商发来的数据并验证后在支付管道逐量支付，直到传输作业完成。

目前必须接收全部数据，但将来可以使用 IPLD 选择器选择自定义子集进行取回作业。

## 通过CID找数据

为要提取一些数据，您将需要用于创建存储交易的 CID。

您实际上可以查询客户端以提供所有已知有存储某些数据的存储供应商:

```shell
lotus client find <Data CID>
```

## 创建检索交易

_检索交易_　的流程简化成一个简单的指令:

```shell
lotus client retrieve --miner <miner ID> <Data CID> <outfile>
```

此指令采用其他可选标志（查看 `--help`）。

如果 outfile 不存在，它将在 Lotus 仓库目录中创建。此过程可能需要 2 到 10 分钟。

{{< alert >}}
如果您添加了一个序列化 IPLD-DAG 的 CAR 文件，其格式无法轻松转换为文件（即任何非 unixfs），请传递 `--car` 标志并根据需要以手动去反序列化 DAG。
{{< /alert >}}
